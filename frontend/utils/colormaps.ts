/**
 * Colormap lookup tables for depth visualization
 *
 * Turbo: Google's improved rainbow colormap - best for depth detail
 * Viridis: Perceptually uniform, colorblind-friendly
 */

// Turbo colormap (Google) - 256 RGB values
// Source: https://gist.github.com/mikhailov-work/ee72ba4191942acecc03fe6da94fc73f
export const TURBO_COLORMAP: [number, number, number][] = [
  [48, 18, 59], [50, 21, 67], [51, 24, 74], [52, 27, 81], [53, 30, 88], [54, 33, 95],
  [55, 36, 102], [56, 39, 109], [57, 42, 115], [58, 45, 121], [59, 47, 128], [60, 50, 134],
  [61, 53, 139], [62, 56, 145], [63, 59, 151], [63, 62, 156], [64, 64, 162], [65, 67, 167],
  [65, 70, 172], [66, 73, 177], [66, 75, 181], [67, 78, 186], [68, 81, 191], [68, 84, 195],
  [68, 86, 199], [69, 89, 203], [69, 92, 207], [69, 94, 211], [70, 97, 214], [70, 100, 218],
  [70, 102, 221], [70, 105, 224], [70, 107, 227], [71, 110, 230], [71, 113, 233], [71, 115, 235],
  [71, 118, 238], [71, 120, 240], [71, 123, 242], [70, 125, 244], [70, 128, 246], [70, 130, 248],
  [70, 133, 250], [70, 135, 251], [69, 138, 252], [69, 140, 253], [68, 143, 254], [67, 145, 254],
  [66, 148, 255], [65, 150, 255], [64, 153, 255], [62, 155, 254], [61, 158, 254], [59, 160, 253],
  [58, 163, 252], [56, 165, 251], [55, 168, 250], [53, 171, 248], [51, 173, 247], [49, 175, 245],
  [47, 178, 244], [46, 180, 242], [44, 183, 240], [42, 185, 238], [40, 188, 235], [39, 190, 233],
  [37, 192, 231], [35, 195, 228], [34, 197, 226], [32, 199, 223], [31, 201, 221], [30, 203, 218],
  [28, 205, 216], [27, 208, 213], [26, 210, 210], [26, 212, 208], [25, 213, 205], [24, 215, 202],
  [24, 217, 200], [24, 219, 197], [24, 221, 194], [24, 222, 192], [24, 224, 189], [25, 226, 187],
  [25, 227, 185], [26, 228, 182], [28, 230, 180], [29, 231, 178], [31, 233, 175], [32, 234, 172],
  [34, 235, 170], [37, 236, 167], [39, 238, 164], [42, 239, 161], [44, 240, 158], [47, 241, 155],
  [50, 242, 152], [53, 243, 148], [56, 244, 145], [60, 245, 142], [63, 246, 138], [67, 247, 135],
  [70, 248, 132], [74, 248, 128], [78, 249, 125], [82, 250, 122], [85, 250, 118], [89, 251, 115],
  [93, 252, 111], [97, 252, 108], [101, 253, 105], [105, 253, 102], [109, 254, 98], [113, 254, 95],
  [117, 254, 92], [121, 254, 89], [125, 255, 86], [128, 255, 83], [132, 255, 81], [136, 255, 78],
  [139, 255, 75], [143, 255, 73], [146, 255, 71], [150, 254, 68], [153, 254, 66], [156, 254, 64],
  [159, 253, 63], [161, 253, 61], [164, 252, 60], [167, 252, 58], [169, 251, 57], [172, 251, 56],
  [175, 250, 55], [177, 249, 54], [180, 248, 54], [183, 247, 53], [185, 246, 53], [188, 245, 52],
  [190, 244, 52], [193, 243, 52], [195, 241, 52], [198, 240, 52], [200, 239, 52], [203, 237, 52],
  [205, 236, 52], [208, 234, 52], [210, 233, 53], [212, 231, 53], [215, 229, 53], [217, 228, 54],
  [219, 226, 54], [221, 224, 55], [223, 223, 55], [225, 221, 55], [227, 219, 56], [229, 217, 56],
  [231, 215, 57], [233, 213, 57], [235, 211, 57], [236, 209, 58], [238, 207, 58], [239, 205, 58],
  [241, 203, 58], [242, 201, 58], [244, 199, 58], [245, 197, 58], [246, 195, 58], [247, 193, 58],
  [248, 190, 57], [249, 188, 57], [250, 186, 57], [251, 184, 56], [251, 182, 55], [252, 179, 54],
  [252, 177, 54], [253, 174, 53], [253, 172, 52], [254, 169, 51], [254, 167, 50], [254, 164, 49],
  [254, 161, 48], [254, 158, 47], [254, 155, 45], [254, 153, 44], [254, 150, 43], [254, 147, 42],
  [254, 144, 41], [253, 141, 39], [253, 138, 38], [252, 135, 37], [252, 132, 35], [251, 129, 34],
  [251, 126, 33], [250, 123, 31], [249, 120, 30], [249, 117, 29], [248, 114, 28], [247, 111, 26],
  [246, 108, 25], [245, 105, 24], [244, 102, 23], [243, 99, 21], [242, 96, 20], [241, 93, 19],
  [240, 91, 18], [239, 88, 17], [237, 85, 16], [236, 83, 15], [235, 80, 14], [234, 78, 13],
  [232, 75, 12], [231, 73, 12], [229, 71, 11], [228, 69, 10], [226, 67, 10], [225, 65, 9],
  [223, 63, 8], [221, 61, 8], [220, 59, 7], [218, 57, 7], [216, 55, 6], [214, 53, 6],
  [212, 51, 5], [210, 49, 5], [208, 47, 5], [206, 45, 4], [204, 43, 4], [202, 42, 4],
  [200, 40, 3], [197, 38, 3], [195, 37, 3], [193, 35, 2], [190, 33, 2], [188, 32, 2],
  [185, 30, 2], [183, 29, 2], [180, 27, 1], [178, 26, 1], [175, 24, 1], [172, 23, 1],
  [169, 22, 1], [167, 20, 1], [164, 19, 1], [161, 18, 1], [158, 16, 1], [155, 15, 1],
  [152, 14, 1], [149, 13, 1], [146, 11, 1], [142, 10, 1], [139, 9, 2], [136, 8, 2],
  [133, 7, 2], [129, 6, 2], [126, 5, 2], [122, 4, 3],
];

// Viridis colormap (matplotlib) - 256 RGB values
// Perceptually uniform, colorblind-friendly
export const VIRIDIS_COLORMAP: [number, number, number][] = [
  [68, 1, 84], [68, 2, 86], [69, 4, 87], [69, 5, 89], [70, 7, 90], [70, 8, 92],
  [70, 10, 93], [70, 11, 94], [71, 13, 96], [71, 14, 97], [71, 16, 99], [71, 17, 100],
  [71, 19, 101], [72, 20, 103], [72, 22, 104], [72, 23, 105], [72, 24, 106], [72, 26, 108],
  [72, 27, 109], [72, 28, 110], [72, 29, 111], [72, 31, 112], [72, 32, 113], [72, 33, 115],
  [72, 35, 116], [72, 36, 117], [72, 37, 118], [72, 38, 119], [72, 40, 120], [72, 41, 121],
  [71, 42, 122], [71, 44, 122], [71, 45, 123], [71, 46, 124], [71, 47, 125], [70, 48, 126],
  [70, 50, 126], [70, 51, 127], [69, 52, 128], [69, 53, 129], [69, 55, 129], [68, 56, 130],
  [68, 57, 131], [68, 58, 131], [67, 60, 132], [67, 61, 132], [66, 62, 133], [66, 63, 133],
  [66, 64, 134], [65, 66, 134], [65, 67, 135], [64, 68, 135], [64, 69, 136], [63, 71, 136],
  [63, 72, 137], [62, 73, 137], [62, 74, 137], [62, 76, 138], [61, 77, 138], [61, 78, 138],
  [60, 79, 139], [60, 80, 139], [59, 82, 139], [59, 83, 140], [58, 84, 140], [58, 85, 140],
  [57, 86, 141], [57, 88, 141], [56, 89, 141], [56, 90, 141], [55, 91, 142], [55, 92, 142],
  [54, 94, 142], [54, 95, 142], [53, 96, 142], [53, 97, 143], [52, 98, 143], [52, 100, 143],
  [51, 101, 143], [51, 102, 143], [50, 103, 143], [50, 105, 144], [49, 106, 144], [49, 107, 144],
  [49, 108, 144], [48, 110, 144], [48, 111, 144], [47, 112, 144], [47, 113, 144], [46, 114, 144],
  [46, 116, 144], [46, 117, 144], [45, 118, 144], [45, 119, 144], [44, 121, 144], [44, 122, 144],
  [44, 123, 144], [43, 124, 144], [43, 126, 144], [43, 127, 144], [42, 128, 144], [42, 129, 144],
  [42, 130, 144], [41, 132, 144], [41, 133, 144], [41, 134, 143], [40, 135, 143], [40, 137, 143],
  [40, 138, 143], [39, 139, 143], [39, 140, 143], [39, 142, 142], [39, 143, 142], [38, 144, 142],
  [38, 145, 142], [38, 147, 141], [38, 148, 141], [37, 149, 141], [37, 150, 140], [37, 152, 140],
  [37, 153, 139], [37, 154, 139], [36, 155, 138], [36, 157, 138], [36, 158, 137], [36, 159, 137],
  [36, 160, 136], [36, 162, 136], [36, 163, 135], [35, 164, 135], [35, 165, 134], [35, 167, 133],
  [35, 168, 133], [35, 169, 132], [35, 170, 131], [35, 172, 131], [35, 173, 130], [35, 174, 129],
  [35, 175, 128], [35, 177, 128], [35, 178, 127], [35, 179, 126], [35, 180, 125], [35, 182, 124],
  [36, 183, 124], [36, 184, 123], [36, 185, 122], [36, 187, 121], [37, 188, 120], [37, 189, 119],
  [38, 190, 118], [38, 191, 117], [39, 193, 116], [39, 194, 115], [40, 195, 114], [41, 196, 113],
  [41, 197, 112], [42, 199, 111], [43, 200, 110], [44, 201, 109], [45, 202, 108], [46, 203, 107],
  [47, 205, 106], [48, 206, 104], [49, 207, 103], [50, 208, 102], [51, 209, 101], [53, 210, 100],
  [54, 211, 99], [55, 212, 97], [57, 213, 96], [58, 214, 95], [60, 215, 94], [61, 216, 93],
  [63, 217, 91], [64, 218, 90], [66, 219, 89], [68, 220, 87], [70, 221, 86], [71, 222, 85],
  [73, 223, 83], [75, 224, 82], [77, 224, 81], [79, 225, 79], [81, 226, 78], [83, 227, 76],
  [85, 227, 75], [87, 228, 73], [89, 229, 72], [91, 230, 71], [93, 230, 69], [96, 231, 68],
  [98, 232, 66], [100, 232, 65], [102, 233, 63], [105, 233, 62], [107, 234, 60], [109, 234, 59],
  [112, 235, 58], [114, 235, 56], [116, 236, 55], [119, 236, 54], [121, 237, 52], [124, 237, 51],
  [126, 238, 50], [128, 238, 49], [131, 238, 47], [133, 239, 46], [136, 239, 45], [138, 239, 44],
  [141, 240, 43], [143, 240, 42], [146, 240, 41], [148, 240, 40], [150, 241, 40], [153, 241, 39],
  [155, 241, 38], [158, 241, 38], [160, 242, 37], [163, 242, 37], [165, 242, 37], [168, 242, 36],
  [170, 242, 36], [172, 242, 36], [175, 243, 36], [177, 243, 36], [180, 243, 36], [182, 243, 37],
  [185, 243, 37], [187, 243, 37], [189, 243, 38], [192, 243, 38], [194, 243, 39], [197, 243, 39],
  [199, 243, 40], [201, 243, 41], [204, 243, 42], [206, 243, 43], [208, 243, 44], [211, 243, 45],
  [213, 243, 46], [215, 243, 47], [217, 243, 49], [220, 243, 50], [222, 243, 51], [224, 243, 53],
  [226, 243, 54], [228, 243, 56], [230, 243, 58], [232, 243, 59], [234, 243, 61], [236, 243, 63],
  [238, 243, 65], [240, 243, 67], [242, 243, 69], [244, 243, 71], [246, 243, 73], [248, 243, 75],
];

/**
 * Apply a colormap to a grayscale value
 * @param gray - Grayscale value (0-255)
 * @param colormap - Colormap lookup table
 * @returns RGB tuple
 */
export function applyColormap(
  gray: number,
  colormap: [number, number, number][]
): [number, number, number] {
  const idx = Math.min(255, Math.max(0, Math.floor(gray)));
  return colormap[idx];
}

export type ColormapType = 'turbo' | 'viridis' | 'grayscale';

export const COLORMAPS: Record<Exclude<ColormapType, 'grayscale'>, [number, number, number][]> = {
  turbo: TURBO_COLORMAP,
  viridis: VIRIDIS_COLORMAP,
};
